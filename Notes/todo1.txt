move partner code from base_classes